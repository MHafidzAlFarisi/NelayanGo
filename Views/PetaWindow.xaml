<Window x:Class="NelayanGo.Views.PetaWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:NelayanGo.ViewModels"
        xmlns:gmap="clr-namespace:GMap.NET.WindowsPresentation;assembly=GMap.NET.WindowsPresentation"
        mc:Ignorable="d"
        Title="NELAYAN GO - Maps &amp; Cuaca" Height="750" Width="1200"
        Background="#F0F0F0">

    <Window.DataContext>
        <vm:PetaCuacaViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <!-- Style untuk efek bayangan sederhana -->
        <DropShadowEffect x:Key="ShadowDepth1" BlurRadius="5" ShadowDepth="2" Direction="270" Opacity="0.1"/>

        <!-- Style untuk Kartu Cuaca -->
        <Style TargetType="{x:Type Border}" x:Key="WeatherCard">
            <Setter Property="Background" Value="#E6F2FF"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="0,10,0,10"/>
        </Style>

        <!-- Style untuk Label Koordinat -->
        <Style TargetType="{x:Type TextBlock}" x:Key="CoordLabel">
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <!-- Header -->
            <RowDefinition Height="*"/>
            <!-- Konten -->
        </Grid.RowDefinitions>

        <!-- === HEADER (ROW 0) === -->
        <Grid Grid.Row="0" Background="#0361A0">
            <!-- ... (Header Code sama seperti sebelumnya, disingkat agar fokus ke konten) ... -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                <TextBlock Text="N" FontFamily="Segoe UI" Foreground="White" FontSize="20" FontWeight="Bold" Margin="0,0,5,0"/>
                <TextBlock Text="NELAYAN GO" FontFamily="Segoe UI" Foreground="White" FontSize="20" FontWeight="SemiBold"/>
            </StackPanel>
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                <TextBlock x:Name="HomeLink" Cursor="Hand" MouseLeftButtonDown="HomeLink_MouseLeftButtonDown" Text="Home" Foreground="White" VerticalAlignment="Center" Margin="20,0,20,0"/>
                <TextBlock x:Name="HasilTangkapanLink" Cursor="Hand" MouseLeftButtonDown="HasilTangkapanLink_MouseLeftButtonDown" Text="Hasil Tangkapan" Foreground="White" VerticalAlignment="Center" Margin="0,0,20,0"/>
                <TextBlock x:Name="MapsLink" Cursor="Hand" MouseLeftButtonDown="MapsLink_MouseLeftButtonDown" Text="Maps" Foreground="White" VerticalAlignment="Center" FontWeight="Bold" Margin="0,0,20,0"/>
                <TextBlock x:Name="HargaPasarLink" Cursor="Hand" MouseLeftButtonDown="HargaPasarLink_MouseLeftButtonDown" Text="Harga Pasar" Foreground="White" VerticalAlignment="Center" Margin="0,0,20,0"/>
            </StackPanel>
            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="143,0,0,0" Height="60" VerticalAlignment="Top">
                <StackPanel VerticalAlignment="Center" Cursor="Hand" MouseLeftButtonDown="ProfileHeader_Click">
                    <TextBlock Text="FIKRI HOIRUL" Foreground="White" FontSize="14" FontWeight="SemiBold"/>
                    <TextBlock Text="TGL-32" Foreground="White" FontSize="12"/>
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- === KONTEN UTAMA (ROW 1) === -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <!-- Kolom Peta -->
                <ColumnDefinition Width="320"/>
                <!-- Kolom Cuaca (Sedikit diperlebar) -->
            </Grid.ColumnDefinitions>

            <!-- KIRI: PETA DAN KOORDINAT -->
            <Border Grid.Column="0" Background="White" CornerRadius="10" Padding="15" Effect="{StaticResource ShadowDepth1}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Mode Selector -->
                        <RowDefinition Height="*"/>
                        <!-- Peta -->
                        <RowDefinition Height="Auto"/>
                        <!-- Input Koordinat -->
                    </Grid.RowDefinitions>

                    <!-- 1. Mode Selector -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Pilih Mode Klik Peta: " FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <RadioButton Content="Set Posisi Awal" IsChecked="True" GroupName="MapMode" Checked="Radio_Checked_Awal" Margin="0,0,15,0"/>
                        <RadioButton Content="Set Tujuan" GroupName="MapMode" Checked="Radio_Checked_Tujuan"/>
                    </StackPanel>

                    <!-- 2. PETA (GMap Control) -->
                    <Border Grid.Row="1" BorderBrush="#ccc" BorderThickness="1" CornerRadius="5" Margin="0,0,0,15" ClipToBounds="True">
                        <!-- GMapControl menggantikan Image placeholder -->
                        <gmap:GMapControl x:Name="MainMap" 
                                          MouseDoubleClick="MainMap_MouseDoubleClick"/>
                    </Border>

                    <!-- 3. Area Input Koordinat -->
                    <StackPanel Grid.Row="2">
                        <!-- Koordinat Awal -->
                        <TextBlock Text="Koordinat Posisi Awal (Latitude, Longitude)" Style="{StaticResource CoordLabel}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding StartLat, UpdateSourceTrigger=PropertyChanged}" Padding="5" TextChanged="Coordinate_TextChanged"/>
                            <TextBox Grid.Column="2" Text="{Binding StartLng, UpdateSourceTrigger=PropertyChanged}" Padding="5" TextChanged="Coordinate_TextChanged"/>
                            <Button Grid.Column="3" Content="📍 Lokasi Saya" Click="BtnCurrentLoc_Click" Margin="10,0,0,0" Padding="10,5" Background="#0361A0" Foreground="White" BorderThickness="0">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="5"/>
                                    </Style>
                                </Button.Resources>
                            </Button>
                        </Grid>

                        <!-- Koordinat Tujuan -->
                        <TextBlock Text="Koordinat Tujuan (Latitude, Longitude)" Style="{StaticResource CoordLabel}" Margin="0,15,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="10"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Text="{Binding EndLat, UpdateSourceTrigger=PropertyChanged}" Padding="5" TextChanged="Coordinate_TextChanged"/>
                            <TextBox Grid.Column="2" Text="{Binding EndLng, UpdateSourceTrigger=PropertyChanged}" Padding="5" TextChanged="Coordinate_TextChanged"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- KANAN: DETAIL CUACA -->
            <StackPanel Grid.Column="1" Margin="20,0,0,0">
                <TextBlock Text="Cuaca" FontSize="20" FontWeight="Bold" Foreground="#333" Margin="0,0,0,5"/>

                <!-- Kartu Cuaca Awal -->
                <TextBlock Text="Cuaca Awal" FontSize="14" FontWeight="SemiBold" Margin="0,10,0,0"/>
                <Border Style="{StaticResource WeatherCard}">
                    <Grid DataContext="{Binding CuacaAwal}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <!-- Ikon & Suhu -->
                            <ColumnDefinition Width="*"/>
                            <!-- Detail -->
                        </Grid.ColumnDefinitions>

                        <!-- Suhu -->
                        <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,15,0">
                            <TextBlock Text="{Binding IconEmoji}" FontSize="36" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Suhu}" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#333"/>
                            <TextBlock Text="Precip: 10%" FontSize="10" Foreground="Gray" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Detail Angin (Kotak Biru) -->
                        <Border Grid.Column="1" Background="#0361A0" CornerRadius="8" Padding="10">
                            <StackPanel VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                                    <TextBlock Text="💨" Foreground="White" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding KecepatanAngin}" FontSize="18" FontWeight="Bold" Foreground="White"/>
                                </StackPanel>
                                <TextBlock Text="{Binding ArahAngin}" FontSize="12" Foreground="#ddd" HorizontalAlignment="Center" TextWrapping="Wrap"/>
                                <TextBlock Text="Kelembapan:" FontSize="10" Foreground="#ccc" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding Humidity}" FontSize="12" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- Kartu Cuaca Tujuan -->
                <TextBlock Text="Cuaca Tujuan" FontSize="14" FontWeight="SemiBold" Margin="0,15,0,0"/>
                <Border Style="{StaticResource WeatherCard}" Background="#0361A0">
                    <!-- Background Biru -->
                    <Grid DataContext="{Binding CuacaTujuan}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Suhu (Teks Putih karena background biru) -->
                        <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,15,0">
                            <TextBlock Text="{Binding IconEmoji}" FontSize="36" HorizontalAlignment="Center"/>
                            <TextBlock Text="{Binding Suhu}" FontSize="28" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                            <TextBlock Text="Precip: 5%" FontSize="10" Foreground="#ddd" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Detail Angin (Kotak Putih Transparan) -->
                        <Border Grid.Column="1" Background="#33FFFFFF" CornerRadius="8" Padding="10">
                            <StackPanel VerticalAlignment="Center">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                                    <TextBlock Text="💨" Foreground="White" FontSize="16" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding KecepatanAngin}" FontSize="18" FontWeight="Bold" Foreground="White"/>
                                </StackPanel>
                                <TextBlock Text="{Binding ArahAngin}" FontSize="12" Foreground="White" HorizontalAlignment="Center" TextWrapping="Wrap"/>
                                <TextBlock Text="Kelembapan:" FontSize="10" Foreground="#ddd" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding Humidity}" FontSize="12" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

            </StackPanel>
        </Grid>
    </Grid>
</Window>